pipeline {
    agent any
    stages {
        stage('Build') {
            steps {
                echo 'Building...'
            }
        }
        stage('Test') {
            steps {
                echo 'Running Unit Tests...'
                // Command to run unit tests, e.g., `npm test` for Jest or Mocha
                sh 'npm test'
            }
        }

        stage('Integration Test') {
            when {
                expression { currentBuild.resultIsBetterOrEqualTo('SUCCESS') }
            }
            steps {
                echo 'Running Integration Tests...'
                // Add your integration test command here, e.g., Jest or Mocha with specific integration test files
                sh 'npm run test:integration'
            }
        }

        stage('E2E Tests') {
            when {
                expression { currentBuild.resultIsBetterOrEqualTo('SUCCESS') }
            }
            steps {
                echo 'Running E2E Tests...'
                // Add E2E test command, e.g., Cypress or Selenium
                sh 'npm run test:e2e'
            }
        }
        stage('Deploy') {
            steps {
                echo 'Deploying...'
            }
        }
    }
}
